(()=>{"use strict";const e=(e,t,o,n)=>{0===e.length?(t.classList.remove("app__content_show"),o.classList.remove("app__footer_show")):(t.classList.add("app__content_show"),o.classList.add("app__footer_show"))},t=(e,t)=>{let o=0;for(let t of e)t.classList.contains("item_completed")&&o++;let n=e.length-o;t.textContent=1===n?`${n} item left`:`${n} items left`},o=(e,t,o)=>{e.target.closest(".item").classList.add("item_edited"),t.value=o.textContent,t.focus()},n=(e,t,o)=>{""===t.value?t.closest(".item").remove():o.textContent=t.value,e.target.closest(".item").classList.remove("item_edited")},i=(e,t)=>{"Enter"===e.key&&t.blur()},l=(e,o,n)=>{e.target.closest(".item").classList.toggle("item_completed"),t(o,n)},s=(e,t,s,c,r,a,d)=>{if(""===e.value)return;t||(s.checked=t,t=!t);const m=c.cloneNode(!0),h=m.querySelector(".item__content"),u=m.querySelector("input[type='checkbox']"),p=m.querySelector(".item__checkbox"),y=m.querySelector(".item__edit input"),_=Date.now();h.textContent=e.value,u.id+="_"+_,p.htmlFor+="_"+_,h.addEventListener("dblclick",(e=>{o(e,y,h)})),y.addEventListener("blur",(e=>{n(e,y,h)})),y.addEventListener("keydown",(e=>{i(e,y)})),u.addEventListener("change",(e=>{l(e,a,d)})),r.append(m),e.value=""},c=(e,t)=>{for(let t of e)t.style.display="flex";switch(t){case"active":for(let t of e)t.classList.contains("item_completed")&&(t.style.display="none");break;case"completed":for(let t of e)t.classList.contains("item_completed")||(t.style.display="none")}},r=document.querySelector(".app__items-list"),a=r.children,d=document.querySelector(".app__content"),m=d.querySelector("#toggle-all"),h=document.querySelector(".app__footer"),u=h.querySelector(".app__items-left"),p=h.querySelector(".app__buttons"),y=h.querySelector(".app__clear-button"),_=document.querySelector(".app__header input"),f=document.getElementById("task-template").content.querySelector(".item");let g=!1,v="all";_.addEventListener("blur",(()=>{s(_,g,m,f,r,a,u),e(a,d,h),t(a,u),c(a,v)})),_.addEventListener("keydown",(o=>{"Enter"===o.key&&(s(_,g,m,f,r,a,u),e(a,d,h),t(a,u),c(a,v))})),r.addEventListener("click",(o=>{1===a.length&&(g=!g),"item__button"===o.target.className&&(o.target.closest(".item").remove(),e(a,d,h),t(a,u)),"checkbox"===o.target.type&&setTimeout((()=>{c(a,v)}),150)})),m.addEventListener("change",(e=>{0===a.length&&(e.target.checked=!1);let o=r.querySelectorAll("input[type='checkbox']");if(e.target.checked)for(let e of o)e.checked=!0,e.closest(".item").classList.add("item_completed");else for(let e of o)e.checked=!1,e.closest(".item").classList.remove("item_completed");t(a,u),c(a,v)})),p.addEventListener("click",(e=>{if(e.target.classList.contains("app__button")){for(let e of p.children)e.classList.remove("app__button_active");e.target.classList.add("app__button_active"),e.target.href&&(v=e.target.href.split("#").pop(),c(a,v))}})),y.addEventListener("click",(()=>{Array.from(a).map((e=>{e.classList.contains("item_completed")&&e.remove()})),t(a,u),e(a,d,h)})),document.addEventListener("DOMContentLoaded",(()=>{((e,t)=>{if(localStorage.getItem("content")){e.innerHTML=localStorage.getItem("content");for(let s of e.children){s.classList.contains("item_completed")&&(s.querySelector("input[type='checkbox']").checked=!0);let c=s.querySelector(".item__edit input"),r=s.querySelector(".item__content"),a=s.querySelector("input[type='checkbox']");r.addEventListener("dblclick",(e=>{o(e,c,r)})),c.addEventListener("blur",(e=>{n(e,c,r)})),c.addEventListener("keydown",(e=>{i(e,c)})),a.addEventListener("change",(o=>{l(o,e.children,t)}))}}else console.log("localStorage пуст!")})(r,u),e(a,d,h),t(a,u),c(a,v)})),window.onbeforeunload=()=>{localStorage.setItem("content",r.innerHTML)};const L=document.getElementsByClassName("stars")[0];L.width=window.innerWidth,L.height=window.innerHeight;let k=L.getContext("2d");function w(e,t){return Math.floor(Math.random()*e)+t}function S(e,t,o,n,i){this.x=e,this.y=t,this.endy=o,this.velocity=n,this.opacity=i,this.draw=function(){k.beginPath(),k.moveTo(this.x,this.y),k.lineTo(this.x,this.y-this.endy),k.lineWidth=1,k.strokeStyle="rgba(255, 255, 255, "+this.opacity+")",k.stroke()},this.update=function(){let e=window.innerHeight+100;this.y>=e?this.y=this.endy-100:this.y=this.y+this.velocity,this.draw()}}const b=[];for(let e=0;e<500;e++){let e=Math.floor(Math.random()*window.innerWidth)+1,t=-500*Math.random(),o=w(10,2),n=w(20,.2),i=.55*Math.random();b.push(new S(e,t,o,n,i))}function E(){requestAnimationFrame(E),k.clearRect(0,0,window.innerWidth,window.innerHeight);for(let e=0;e<b.length;e++)b[e].update()}const q=document.querySelector(".ufo"),x=document.querySelector(".app__title");let C=0,M=!0;q.addEventListener("click",(()=>{if(M){if(C++,5!==C)return;M=!M;let e=setInterval((()=>{let e="#"+Math.floor(16777215*Math.random()).toString(16);q.style.backgroundColor=e,x.style.color=e}),600);const t=parseInt(getComputedStyle(q).width),o=parseInt(getComputedStyle(q).height);window.addEventListener("click",(e=>{q.style.top=e.clientY-o/2+"px",q.style.left=e.clientX-t/2+"px"})),setTimeout((()=>{q.addEventListener("dblclick",(()=>{clearInterval(e),q.style.zIndex="-1",q.style.opacity="0",q.style.cursor="auto",x.style.color="#C5D0E6"}))}),2e3),document.body.classList.add("dark"),E()}}))})();